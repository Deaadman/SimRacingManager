@page "/"

@using SimRacingManager.Core
@using SimRacingManager.Data
@using SimRacingManager.Enumerations

@inject NavigationManager Navigation

@rendermode InteractiveServer

@* TODO: Reverse the order of the championships, from newest to oldest. So Q4 to Q1 *@
@* TODO: Add each year in dynamically as well *@
<MudTable T="Championship" Items="@Championships.ChampionshipsList" Filter="Filter" Hover="true" RowClass="cursor-pointer" OnRowClick="RowClickEvent">
    <ToolBarContent>
        <MudText Typo="Typo.h6">2025</MudText>
    </ToolBarContent>
    <HeaderContent>
        <MudTh>Name</MudTh>
        <MudTh>Status</MudTh>
    </HeaderContent>
    <RowTemplate>
        <MudTd DataLabel="Name">@context.Name</MudTd>
        <MudTd DataLabel="Status"><MudChip T="string" Label="true" Color="@context.ChampionshipStatusColour">@context.Status</MudChip></MudTd>
    </RowTemplate>
</MudTable>

@code {

    private Dictionary<Status, Color> _testing = new();
    
    protected override void OnInitialized()
    {
        _testing.Add(Status.Completed, Color.Error);
        _testing.Add(Status.Ongoing, Color.Success);
        _testing.Add(Status.Upcoming, Color.Warning);

        foreach (var championship in Championships.ChampionshipsList)
        { 
            foreach (var colour in _testing)
            {
                if (colour.Key == championship.Status)
                {
                    championship.ChampionshipStatusColour = colour.Value;
                }
            }
        }
    }

    private bool Filter(Championship championship)
    {
        if (championship.Year == 2025)
        {
            return true;
        }

        return false;
    }
    
    private void RowClickEvent(TableRowClickEventArgs<Championship> tableRowClickEventArgs)
    {
        Navigation.NavigateTo($"ChampionshipDetails/{tableRowClickEventArgs.Item.GUID}");
    }
}